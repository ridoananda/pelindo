import{q as D,j as e,a as R,f as _}from"./app-BA6xctcn.js";import{M as T}from"./MainLayout-DM9qhyGW.js";import{P as C}from"./PageHeader-C2IBvfNU.js";import{T as h}from"./Table-BaOBvU73.js";import{B as i}from"./Button-D_zsYIT9.js";import{n as E,o as d,p}from"./index-DkCnk8dL.js";function U({risks:t,riskReports:o,riskStats:g,reportType:c,reportDate:j,reportPeriod:r,managerName:L}){const{url:u}=D(),f=[{key:"type",label:"Jenis Risiko",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"mr-2 text-red-600"}),e.jsx("span",{className:"font-medium",children:s.type})]})},{key:"impact",label:"Dampak",render:s=>e.jsx("span",{className:"text-gray-600",children:s.impact})},{key:"status",label:"Tingkat Risiko",render:s=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="Tinggi"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:s.status})},{key:"recommendation",label:"Rekomendasi",render:s=>e.jsx("span",{className:"text-gray-600 text-sm",children:s.recommendation?s.recommendation.length>50?s.recommendation.substring(0,50)+"...":s.recommendation:"-"})}],b=[{key:"report_date",label:"Tanggal Laporan",render:s=>e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(p,{className:"mr-2 text-gray-600"}),e.jsx("span",{children:s.report_date?new Date(s.report_date).toLocaleDateString("id-ID"):"-"})]})},{key:"risk_type",label:"Jenis Risiko",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"mr-2 text-red-600"}),e.jsx("span",{className:"font-medium",children:s.risk_type})]})},{key:"description",label:"Deskripsi",render:s=>e.jsx("span",{className:"text-gray-600 text-sm",children:s.description?s.description.length>100?s.description.substring(0,100)+"...":s.description:"-"})},{key:"recommended_action",label:"Tindakan yang Direkomendasikan",render:s=>e.jsx("span",{className:"text-gray-600 text-sm",children:s.recommended_action?s.recommended_action.length>100?s.recommended_action.substring(0,100)+"...":s.recommended_action:"-"})}],N=()=>{window.print()},m=s=>{const l=new URL(window.location.origin+u);l.searchParams.set("format",s);const k=l.pathname+l.search;_.get(k,{},{preserveState:!0,preserveScroll:!0,onSuccess:a=>{a.props.flash&&a.props.flash.report_url?window.open(a.props.flash.report_url,"_blank"):a.props.flash&&a.props.flash.error?alert(`Error generating report: ${a.props.flash.error}`):alert("Report generation requested. If download does not start, the server may not have provided a download URL.")},onError:a=>{const x=Object.keys(a)[0],v=x?a[x]:"Unknown error.";alert(`Failed to request downloadable report: ${v}`),console.error("Report download request errors:",a)}})},y=()=>{m("pdf")},w=()=>{m("excel")},n=g||{total:t.length,tinggi:t.filter(s=>s.status==="Tinggi").length,normal:t.filter(s=>s.status==="Normal").length};return e.jsxs(T,{children:[e.jsx(R,{title:c}),e.jsx(C,{title:c,description:`Periode: ${r} | Dibuat pada: ${j}`,pattern:"grid"}),e.jsxs("div",{className:"p-4 md:p-8 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Risiko"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.total})]}),e.jsx(E,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tinggi"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:n.tinggi})]}),e.jsx("div",{className:"h-8 w-8 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-orange-600 font-bold text-sm",children:"⚠"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Normal"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.normal})]}),e.jsx("div",{className:"h-8 w-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 font-bold text-sm",children:"✓"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(d,{className:"mr-2 text-red-600"}),"Daftar Risiko"]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Menampilkan ",t.length," risiko untuk periode ",r]})]}),e.jsx(h,{columns:f,data:t,emptyMessage:"Tidak ada data risiko untuk periode ini."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(p,{className:"mr-2 text-blue-600"}),"Laporan Insiden Risiko"]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Menampilkan ",o.length," laporan insiden untuk periode ",r]})]}),e.jsx(h,{columns:b,data:o,emptyMessage:"Tidak ada laporan insiden risiko untuk periode ini."})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-2",children:[e.jsx(i,{variant:"white",onClick:N,children:"Preview"}),e.jsx(i,{onClick:y,children:"Download PDF"}),e.jsx(i,{variant:"secondary",onClick:w,children:"Download Excel"})]})]})]})}export{U as default};
