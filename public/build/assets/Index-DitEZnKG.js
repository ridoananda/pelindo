import{q as P,r as x,S as A,j as e,a as D}from"./app-5uYfbFD_.js";import{t as b,M as $}from"./MainLayout-CL2HDE20.js";import{P as C}from"./PageHeader-ZxeNOBG7.js";import{B as f}from"./Button-BW1FQsdI.js";import{f as R,g as y,h as j,i as T,j as J}from"./index-6lisLfRC.js";function U({auth:v}){const{flash:s}=P().props,[n,N]=x.useState("logistic"),[o,c]=x.useState(null),{data:r,setData:i,get:k,processing:g,errors:d}=A({month:"",year:new Date().getFullYear().toString(),reportFormat:"pdf"}),m=[{key:"logistic",name:"Laporan Logistik",icon:e.jsx(j,{className:"mr-2"}),color:b.colors.primary[600]},{key:"ships",name:"Laporan Aktivitas Kapal",icon:e.jsx(T,{className:"mr-2"}),color:b.colors.secondary[600]},{key:"risks",name:"Laporan Analisis Risiko",icon:e.jsx(J,{className:"mr-2"}),color:b.colors.accent.warning}],u=m.find(a=>a.key===n),w=a=>{N(a),c(null),i(l=>({...l,month:"",year:new Date().getFullYear().toString()}))},F=a=>{a.preventDefault(),c(null);let l={format:r.reportFormat};if(r.year)l.year=r.year,r.month&&(l.month=r.month);else{alert("Harap pilih periode laporan (Tahun).");return}const p=`reports.${n}`;k(route(p,l),{preserveState:!0,preserveScroll:!0,onSuccess:t=>{t.props.flash&&t.props.flash.error&&alert(t.props.flash.error)},onError:t=>{const h=Object.keys(t)[0];h&&t[h]?alert(`Error: ${t[h]}`):alert("Terjadi kesalahan saat menghasilkan laporan. Periksa kembali input Anda atau coba lagi nanti."),console.error("Report generation errors:",t)}})};x.useEffect(()=>{var a;if(s&&s.report_url){const l=((a=m.find(t=>t.key===n))==null?void 0:a.name)||"Laporan",p=(r.reportFormat||"file").toUpperCase();c({name:`${l} (${p})`,url:s.report_url,fileName:s.file_name||`report.${r.reportFormat}`,generatedAt:new Date().toLocaleString("id-ID",{timeZone:"Asia/Jakarta"})})}},[s,n,r.reportFormat]);const L=Array.from({length:10},(a,l)=>new Date().getFullYear()-l),S=[{value:"",label:"Semua Bulan"},{value:"1",label:"Januari"},{value:"2",label:"Februari"},{value:"3",label:"Maret"},{value:"4",label:"April"},{value:"5",label:"Mei"},{value:"6",label:"Juni"},{value:"7",label:"Juli"},{value:"8",label:"Agustus"},{value:"9",label:"September"},{value:"10",label:"Oktober"},{value:"11",label:"November"},{value:"12",label:"Desember"}];return e.jsxs($,{user:v.user,children:[e.jsx(D,{title:"Pusat Laporan"}),e.jsx(C,{title:"Pusat Laporan Pelabuhan",description:"Hasilkan dan kelola berbagai laporan operasional dan manajerial.",pattern:"compass"}),e.jsxs("div",{className:"p-4 md:p-8 bg-gray-50 min-h-screen",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-1 flex items-center",children:[e.jsx(R,{className:"mr-2 text-blue-600"})," Pilih Jenis & Periode Laporan"]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Pilih jenis laporan yang ingin Anda hasilkan dan tentukan periode waktunya."}),e.jsx("div",{className:"flex flex-wrap gap-3 mb-8 border-b border-gray-200 pb-6",children:m.map(a=>e.jsxs("button",{type:"button",onClick:()=>w(a.key),style:{"--report-color":a.color},className:`flex items-center justify-center px-4 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2
                    ${n===a.key?"text-white shadow-md":"text-gray-700 bg-gray-100 hover:bg-gray-200 focus:ring-gray-400"}
                    ${n===a.key?"bg-[var(--report-color)] hover:bg-opacity-90 focus:ring-[var(--report-color)]":""}
                  `,children:[a.icon," ",a.name]},a.key))}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jenis Laporan Dipilih"}),e.jsx("input",{type:"text",value:(u==null?void 0:u.name)||"Tidak ada",readOnly:!0,className:"w-full rounded-md border-gray-300 bg-gray-100 shadow-sm focus:border-blue-500 focus:ring-blue-500 cursor-not-allowed p-2.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Periode (Bulan & Tahun)"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("select",{name:"month",value:r.month,onChange:a=>i("month",a.target.value),className:"flex-grow w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5",children:S.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))}),e.jsx("select",{name:"year",value:r.year,onChange:a=>i("year",a.target.value),className:"flex-grow w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5",children:L.map(a=>e.jsx("option",{value:a,children:a},a))})]}),d.year&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:d.year}),d.month&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:d.month})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Format Laporan"}),e.jsx("div",{className:"flex space-x-3",children:["pdf","excel"].map(a=>e.jsx("button",{type:"button",onClick:()=>i("reportFormat",a),className:`px-4 py-2.5 rounded-lg text-sm font-medium transition-all w-full
                          ${r.reportFormat===a?"bg-blue-600 text-white shadow-md hover:bg-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"}`,children:a.toUpperCase()},a))})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(f,{type:"submit",disabled:g,className:"bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white shadow-lg hover:shadow-xl transition-all duration-300 ease-in-out transform hover:scale-105",icon:e.jsx(y,{}),children:g?"Menghasilkan...":"Hasilkan Laporan"})})]})]})}),o&&e.jsx("div",{className:"mt-10 bg-white rounded-xl shadow-xl overflow-hidden",children:e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(j,{className:"mr-2 text-green-600"})," Laporan Berhasil Dihasilkan"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nama Laporan:"})," ",o.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tanggal Dihasilkan:"})," ",o.generatedAt]}),o.params&&e.jsxs("p",{children:[e.jsx("strong",{children:"Parameter:"})," ",Object.entries(o.params).map(([a,l])=>`${a}: ${l}`).join(", ")]}),e.jsx(f,{onClick:()=>{if(o&&o.url){const a=document.createElement("a");a.href=o.url,a.download=o.fileName||`report.${r.reportFormat}`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}else alert("URL laporan tidak tersedia atau tidak valid.")},variant:"secondary",className:"bg-green-600 hover:bg-green-700 text-white mt-3",icon:e.jsx(y,{}),children:"Unduh Laporan"})]})]})}),s&&s.error&&e.jsxs("div",{className:"mt-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",s.error]})]}),s&&s.success&&e.jsxs("div",{className:"mt-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg relative",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Sukses!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",s.success]})]})]})]})}export{U as default};
