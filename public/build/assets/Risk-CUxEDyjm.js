import{q as R,j as e,a as D,f as _}from"./app-Crg7uaA9.js";import{M as T}from"./MainLayout-BNay54Bk.js";import{P as E}from"./PageHeader-CDh1lsCH.js";import{T as h}from"./Table-BPlI8wXv.js";import{B as i}from"./Button-Bz6IcbYV.js";import{n as M,o as d,p as g}from"./index-CVUYyXbF.js";function U({risks:a,riskReports:o,riskStats:p,reportType:c,reportDate:j,reportPeriod:r,managerName:C}){const{url:u}=R(),f=[{key:"type",label:"Jenis Risiko",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"mr-2 text-red-600"}),e.jsx("span",{className:"font-medium",children:s.type})]})},{key:"impact",label:"Dampak",render:s=>e.jsx("span",{className:"text-gray-600",children:s.impact})},{key:"status",label:"Tingkat Risiko",render:s=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="Ekstrim"?"bg-red-100 text-red-800":s.status==="Tinggi"?"bg-orange-100 text-orange-800":s.status==="Menengah"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s.status})},{key:"recommendation",label:"Rekomendasi",render:s=>e.jsx("span",{className:"text-gray-600 text-sm",children:s.recommendation?s.recommendation.length>50?s.recommendation.substring(0,50)+"...":s.recommendation:"-"})}],b=[{key:"report_date",label:"Tanggal Laporan",render:s=>e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(g,{className:"mr-2 text-gray-600"}),e.jsx("span",{children:s.report_date?new Date(s.report_date).toLocaleDateString("id-ID"):"-"})]})},{key:"risk_type",label:"Jenis Risiko",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"mr-2 text-red-600"}),e.jsx("span",{className:"font-medium",children:s.risk_type})]})},{key:"description",label:"Deskripsi",render:s=>e.jsx("span",{className:"text-gray-600 text-sm",children:s.description?s.description.length>100?s.description.substring(0,100)+"...":s.description:"-"})},{key:"recommended_action",label:"Tindakan yang Direkomendasikan",render:s=>e.jsx("span",{className:"text-gray-600 text-sm",children:s.recommended_action?s.recommended_action.length>100?s.recommended_action.substring(0,100)+"...":s.recommended_action:"-"})}],N=()=>{window.print()},m=s=>{const l=new URL(window.location.origin+u);l.searchParams.set("format",s);const k=l.pathname+l.search;_.get(k,{},{preserveState:!0,preserveScroll:!0,onSuccess:t=>{t.props.flash&&t.props.flash.report_url?window.open(t.props.flash.report_url,"_blank"):t.props.flash&&t.props.flash.error?alert(`Error generating report: ${t.props.flash.error}`):alert("Report generation requested. If download does not start, the server may not have provided a download URL.")},onError:t=>{const x=Object.keys(t)[0],v=x?t[x]:"Unknown error.";alert(`Failed to request downloadable report: ${v}`),console.error("Report download request errors:",t)}})},y=()=>{m("pdf")},w=()=>{m("excel")},n=p||{total:a.length,ekstrim:a.filter(s=>s.status==="Ekstrim").length,tinggi:a.filter(s=>s.status==="Tinggi").length,menengah:a.filter(s=>s.status==="Menengah").length,rendah:a.filter(s=>s.status==="Rendah").length};return e.jsxs(T,{children:[e.jsx(D,{title:c}),e.jsx(E,{title:c,description:`Periode: ${r} | Dibuat pada: ${j}`,pattern:"grid"}),e.jsxs("div",{className:"p-4 md:p-8 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Risiko"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.total})]}),e.jsx(M,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ekstrim"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.ekstrim})]}),e.jsx("div",{className:"h-8 w-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-red-600 font-bold text-sm",children:"!"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tinggi"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:n.tinggi})]}),e.jsx("div",{className:"h-8 w-8 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-orange-600 font-bold text-sm",children:"⚠"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Menengah"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:n.menengah})]}),e.jsx("div",{className:"h-8 w-8 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-yellow-600 font-bold text-sm",children:"◐"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rendah"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.rendah})]}),e.jsx("div",{className:"h-8 w-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 font-bold text-sm",children:"✓"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(d,{className:"mr-2 text-red-600"}),"Daftar Risiko"]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Menampilkan ",a.length," risiko untuk periode ",r]})]}),e.jsx(h,{columns:f,data:a,emptyMessage:"Tidak ada data risiko untuk periode ini."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(g,{className:"mr-2 text-blue-600"}),"Laporan Insiden Risiko"]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Menampilkan ",o.length," laporan insiden untuk periode ",r]})]}),e.jsx(h,{columns:b,data:o,emptyMessage:"Tidak ada laporan insiden risiko untuk periode ini."})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-2",children:[e.jsx(i,{variant:"white",onClick:N,children:"Preview"}),e.jsx(i,{onClick:y,children:"Download PDF"}),e.jsx(i,{variant:"secondary",onClick:w,children:"Download Excel"})]})]})]})}export{U as default};
