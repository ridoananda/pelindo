import{r as n,S as $,j as e,a as z,f as I}from"./app-JPd7-MDz.js";import{M as J,t as p}from"./MainLayout-BRdvmUMu.js";import{P as K}from"./PageHeader-CoA7Cj9I.js";import{T as y}from"./Table-BfNmKdbL.js";import{B as d}from"./Button-BWH-8Ech.js";import{M as V}from"./Modal-CE_rP1HX.js";import{P as Z,g as q,C as G,a as Q,b as U,B as X,A as Y,p as ee,e as se,f as re}from"./index-BwY8h0x6.js";import"./transition-CYuYb3wZ.js";G.register(Q,U,X,Y,ee,se,re);function he({risks:te,riskStatus:ae,riskReports:ne,riskStats:oe,riskAssessments:c,fmeaAnalysisSummary:r}){const[_,u]=n.useState(!1),[h,k]=n.useState(!1),[C,M]=n.useState(null),[i,R]=n.useState(""),[x,L]=n.useState("Semua"),[b,v]=n.useState("assessments"),{data:o,setData:a,post:O,put:A,errors:t,reset:f,processing:N}=$({respondent_name:"",respondent_job:"Manajer Bistek Operasional",risk_code:"",risk_description:"",severity:1,occurrence:1,detection:1}),P=[{header:"No.",accessor:"id",cell:(s,l,j)=>j+1},{header:"Nama Responden",accessor:"respondent_name"},{header:"Pekerjaan Responden",accessor:"respondent_job",cell:s=>e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:s})},{header:"Kode",accessor:"risk_code",cell:s=>e.jsx("span",{className:"font-mono font-bold text-purple-700",children:s})},{header:"Severity",accessor:"severity",cell:s=>e.jsx("span",{className:`font-bold px-2 py-1 rounded ${s>=7?"bg-red-100 text-red-800":s>=4?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s})},{header:"Occurrence",accessor:"occurrence",cell:s=>e.jsx("span",{className:`font-bold px-2 py-1 rounded ${s>=7?"bg-red-100 text-red-800":s>=4?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s})},{header:"Detection",accessor:"detection",cell:s=>e.jsx("span",{className:`font-bold px-2 py-1 rounded ${s>=7?"bg-red-100 text-red-800":s>=4?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s})}],S=[{header:"Kode",accessor:"kode",cell:s=>e.jsx("span",{className:"font-mono font-bold text-purple-700",children:s})},{header:"Deskripsi",accessor:"deskripsi",cell:s=>e.jsx("div",{className:"max-w-xs whitespace-normal break-words text-sm",children:s})},{header:"Avg S",accessor:"avg_severity",cell:s=>e.jsx("span",{className:"font-bold text-blue-600",children:s})},{header:"Avg O",accessor:"avg_occurrence",cell:s=>e.jsx("span",{className:"font-bold text-green-600",children:s})},{header:"Avg D",accessor:"avg_detection",cell:s=>e.jsx("span",{className:"font-bold text-orange-600",children:s})},{header:"RPN",accessor:"avg_rpn",cell:s=>e.jsx("span",{className:"font-extrabold text-lg text-gray-800",children:s})},{header:"Tingkat Risiko",accessor:"tingkat_risiko",cell:s=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${s==="Tinggi"?"bg-red-500 text-white":s==="Sedang"?"bg-yellow-500 text-white":"bg-green-500 text-white"}`,children:s})}],B=n.useMemo(()=>!c||!Array.isArray(c)?[]:c.filter(s=>{const l=s.respondent_name.toLowerCase().includes(i.toLowerCase())||s.risk_code.toLowerCase().includes(i.toLowerCase())||s.risk_description.toLowerCase().includes(i.toLowerCase()),j=x==="Semua"||s.respondent_job===x;return l&&j}),[c,i,x]),g=n.useMemo(()=>{const s={Tinggi:0,Sedang:0,Rendah:0};return r&&Array.isArray(r)&&r.forEach(l=>{s.hasOwnProperty(l.tingkat_risiko)&&s[l.tingkat_risiko]++}),s},[r]),D={labels:Object.keys(g),datasets:[{data:Object.values(g),backgroundColor:["#ef4444","#f59e0b","#10b981"],borderColor:"#ffffff",borderWidth:3}]},E={labels:r&&Array.isArray(r)?r.slice(0,10).map(s=>s.kode):[],datasets:[{label:"Risk Priority Number (RPN)",data:r&&Array.isArray(r)?r.slice(0,10).map(s=>s.avg_rpn):[],backgroundColor:r&&Array.isArray(r)?r.slice(0,10).map(s=>s.tingkat_risiko==="Tinggi"?"#ef4444":s.tingkat_risiko==="Sedang"?"#f59e0b":"#10b981"):[],borderColor:"#374151",borderWidth:1}]},w={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:p.colors.neutral[700],font:{size:12}}},title:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{color:p.colors.neutral[600]},grid:{color:p.colors.neutral[200]}},x:{ticks:{color:p.colors.neutral[600]},grid:{display:!1}}}},T=()=>{f(),a({respondent_name:"",respondent_job:"Manajer Bistek Operasional",risk_code:"",risk_description:"",severity:1,occurrence:1,detection:1}),k(!1),u(!0)},F=s=>{k(!0),M(s),a({respondent_name:s.respondent_name,respondent_job:s.respondent_job,risk_code:s.risk_code,risk_description:s.risk_description,severity:s.severity,occurrence:s.occurrence,detection:s.detection}),u(!0)},m=()=>{u(!1),f()},W=s=>{s.preventDefault(),h?A(route("risk-assessments.update",C.id),{onSuccess:()=>m()}):O(route("risk-assessments.store"),{onSuccess:()=>m()})},H=s=>{confirm(`Apakah Anda yakin ingin menghapus assessment ${s.respondent_name} untuk kode ${s.risk_code}?`)&&I.delete(route("risk-assessments.destroy",s.id))};return e.jsxs(J,{children:[e.jsx(z,{title:"FMEA Analysis - Analisis Risiko"}),e.jsx(K,{title:"FMEA (Failure Mode and Effects Analysis)",description:"Analisis komprehensif risiko operasional pelabuhan menggunakan metode FMEA dengan pendekatan Risk Priority Number (RPN)",pattern:"shipWheel",actions:e.jsxs(d,{onClick:T,className:"bg-white !text-blue-800 hover:!bg-blue-100 hover:text-white transition-colors shadow-md",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tambah Assessment"]})}),e.jsxs("div",{className:"p-8 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Distribusi Tingkat Risiko"}),e.jsx("div",{className:"h-64",children:Object.values(g).some(s=>s>0)?e.jsx(Z,{data:D,options:w}):e.jsx("p",{className:"text-gray-500 text-center pt-24",children:"Tidak ada data untuk ditampilkan"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Top 10 Risk Priority Number (RPN)"}),e.jsx("div",{className:"h-64",children:r&&r.length>0?e.jsx(q,{data:E,options:w}):e.jsx("p",{className:"text-gray-500 text-center pt-24",children:"Tidak ada data untuk ditampilkan"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-6",children:[e.jsx("button",{onClick:()=>v("assessments"),className:`py-4 px-1 border-b-2 font-medium text-sm ${b==="assessments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Data Penilaian Responden"}),e.jsx("button",{onClick:()=>v("analysis"),className:`py-4 px-1 border-b-2 font-medium text-sm ${b==="analysis"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Hasil Analisis FMEA"})]})}),e.jsx("div",{className:"p-6",children:b==="assessments"?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-1",children:"Data Penilaian Responden"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Kumpulan data penilaian risiko dari berbagai responden"}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-4 space-y-3 md:space-y-0",children:[e.jsx("div",{className:"flex space-x-3",children:e.jsxs("select",{value:x,onChange:s=>L(s.target.value),className:"py-2 pl-3 pr-8 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm",children:[e.jsx("option",{value:"Semua",children:"Semua Jabatan"}),e.jsx("option",{value:"Manajer Bistek Operasional",children:"Manajer Bistek Operasional"}),e.jsx("option",{value:"Petugas Lapangan Operasional",children:"Petugas Lapangan Operasional"})]})}),e.jsxs("div",{className:"relative w-full md:w-2/5",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Cari nama responden, kode risiko...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm",value:i,onChange:s=>R(s.target.value)})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-200",children:e.jsx(y,{columns:P,data:B,actions:s=>e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(d,{variant:"white",size:"sm",onClick:()=>F(s),className:"border border-gray-300 hover:bg-gray-100",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),e.jsxs(d,{variant:"danger",size:"sm",onClick:()=>H(s),className:"bg-red-600 text-white hover:bg-red-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Hapus"]})]})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-1",children:"Hasil Analisis FMEA"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Ringkasan analisis risiko berdasarkan rata-rata penilaian responden"}),e.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-bold text-blue-900 mb-3 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Keterangan Metode FMEA"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white p-3 rounded-md border-l-4 border-blue-500",children:[e.jsx("strong",{className:"text-blue-900",children:"Severity (S):"}),e.jsx("p",{className:"text-blue-800 mt-1",children:"Seberapa parah dampak jika risiko terjadi"})]}),e.jsxs("div",{className:"bg-white p-3 rounded-md border-l-4 border-green-500",children:[e.jsx("strong",{className:"text-green-900",children:"Occurrence (O):"}),e.jsx("p",{className:"text-green-800 mt-1",children:"Seberapa sering risiko kemungkinan terjadi"})]}),e.jsxs("div",{className:"bg-white p-3 rounded-md border-l-4 border-orange-500",children:[e.jsx("strong",{className:"text-orange-900",children:"Detection (D):"}),e.jsx("p",{className:"text-orange-800 mt-1",children:"Seberapa mudah risiko dapat dideteksi"})]})]}),e.jsx("div",{className:"mt-3 text-center bg-white p-2 rounded-md",children:e.jsx("strong",{className:"text-gray-900",children:"Risk Priority Number (RPN) = S × O × D"})})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-200",children:e.jsx(y,{columns:S,data:r||[]})})]})})]})]}),e.jsx(V,{show:_,onClose:m,title:h?"Edit Assessment":"Tambah Assessment Baru",maxWidth:"2xl",children:e.jsxs("form",{onSubmit:W,className:"space-y-4 p-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Responden"}),e.jsx("input",{type:"text",value:o.respondent_name,onChange:s=>a("respondent_name",s.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5",placeholder:"Masukkan nama responden"}),t.respondent_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.respondent_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jabatan Responden"}),e.jsxs("select",{value:o.respondent_job,onChange:s=>a("respondent_job",s.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5",children:[e.jsx("option",{value:"Manajer Bistek Operasional",children:"Manajer Bistek Operasional"}),e.jsx("option",{value:"Petugas Lapangan Operasional",children:"Petugas Lapangan Operasional"})]}),t.respondent_job&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.respondent_job})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kode Risiko"}),e.jsx("input",{type:"text",value:o.risk_code,onChange:s=>a("risk_code",s.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5",placeholder:"Contoh: M01"}),t.risk_code&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.risk_code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi Risiko"}),e.jsx("input",{type:"text",value:o.risk_description,onChange:s=>a("risk_description",s.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5",placeholder:"Deskripsi risiko"}),t.risk_description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.risk_description})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Severity (1-10)"}),e.jsx("input",{type:"number",min:"1",max:"10",value:o.severity,onChange:s=>a("severity",parseInt(s.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5"}),t.severity&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.severity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Occurrence (1-10)"}),e.jsx("input",{type:"number",min:"1",max:"10",value:o.occurrence,onChange:s=>a("occurrence",parseInt(s.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5"}),t.occurrence&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.occurrence})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Detection (1-10)"}),e.jsx("input",{type:"number",min:"1",max:"10",value:o.detection,onChange:s=>a("detection",parseInt(s.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5"}),t.detection&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.detection})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(d,{type:"button",variant:"secondary",onClick:m,children:"Batal"}),e.jsx(d,{type:"submit",disabled:N,children:N?"Menyimpan...":h?"Perbarui":"Simpan"})]})]})})]})}export{he as default};
