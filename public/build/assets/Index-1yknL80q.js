import{r as u,j as e,S as q,a as ge,f as be}from"./app-CoinIA6E.js";import{M as je,t as F}from"./MainLayout-BYuyV-GX.js";import{P as ke}from"./PageHeader-Rbg_npNH.js";import{T as P}from"./Table-DoG381uc.js";import{B as j}from"./Button-D6nxZPqu.js";import{M as K}from"./Modal-FkTiBk6I.js";import{P as fe,g as ve,C as Ne,a as ye,b as we,B as Me,A as Ce,p as Re,e as Le,f as _e}from"./index-CPjELioi.js";import"./transition-BwN6jb7x.js";function Te({isVisible:a,message:o,type:p="info",onClose:r,duration:n=5e3}){const[t,l]=u.useState(!1);u.useEffect(()=>{if(a){l(!0);const m=setTimeout(()=>{c()},n);return()=>clearTimeout(m)}},[a,n]);const c=()=>{l(!1),setTimeout(()=>{r()},300)};if(!a)return null;const i=()=>{switch(p){case"success":return"bg-green-500 text-white border-green-600";case"error":return"bg-red-500 text-white border-red-600";case"warning":return"bg-yellow-500 text-white border-yellow-600";case"info":default:return"bg-blue-500 text-white border-blue-600"}},h=()=>{switch(p){case"success":return e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"warning":return e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":default:return e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}};return e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsxs("div",{className:`
          flex items-center p-4 rounded-lg shadow-lg border max-w-sm transform transition-all duration-300 ease-in-out
          ${i()}
          ${t?"translate-x-0 opacity-100":"translate-x-full opacity-0"}
        `,children:[e.jsx("div",{className:"flex-shrink-0",children:h()}),e.jsx("div",{className:"ml-3 flex-1",children:e.jsx("p",{className:"text-sm font-medium",children:o})}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{onClick:c,className:"inline-flex text-white hover:text-gray-200 focus:outline-none focus:text-gray-200 transition ease-in-out duration-150",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]})})}const C=u.forwardRef(({label:a,name:o,type:p="text",value:r,onChange:n,placeholder:t,error:l,required:c=!1,disabled:i=!1,className:h="",...m},x)=>e.jsxs("div",{className:"space-y-2",children:[a&&e.jsxs("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700",children:[a,c&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("input",{ref:x,id:o,name:o,type:p,value:r,onChange:n,placeholder:t,disabled:i,required:c,className:`
          w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
          ${l?"border-red-300 focus:ring-red-500":"border-gray-300"}
          ${i?"bg-gray-100 cursor-not-allowed":"bg-white"}
          ${h}
        `,...m}),l&&e.jsx("p",{className:"text-sm text-red-600",children:l})]}));C.displayName="Input";const A=u.forwardRef(({label:a,name:o,value:p,onChange:r,placeholder:n,error:t,required:l=!1,disabled:c=!1,rows:i=3,className:h="",...m},x)=>e.jsxs("div",{className:"space-y-2",children:[a&&e.jsxs("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700",children:[a,l&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("textarea",{ref:x,id:o,name:o,value:p,onChange:r,placeholder:n,disabled:c,required:l,rows:i,className:`
          w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-vertical
          ${t?"border-red-300 focus:ring-red-500":"border-gray-300"}
          ${c?"bg-gray-100 cursor-not-allowed":"bg-white"}
          ${h}
        `,...m}),t&&e.jsx("p",{className:"text-sm text-red-600",children:t})]}));A.displayName="Textarea";const L=u.forwardRef(({label:a,name:o,value:p,onChange:r,options:n=[],placeholder:t,error:l,required:c=!1,disabled:i=!1,className:h="",...m},x)=>e.jsxs("div",{className:"space-y-2",children:[a&&e.jsxs("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700",children:[a,c&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("select",{ref:x,id:o,name:o,value:p,onChange:r,disabled:i,required:c,className:`
          w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
          ${l?"border-red-300 focus:ring-red-500":"border-gray-300"}
          ${i?"bg-gray-100 cursor-not-allowed":"bg-white"}
          ${h}
        `,...m,children:[t&&e.jsx("option",{value:"",disabled:!0,children:t}),n.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))]}),l&&e.jsx("p",{className:"text-sm text-red-600",children:l})]}));L.displayName="Select";function Ae({risk:a=null,onClose:o,isEdit:p=!1}){const{data:r,setData:n,post:t,put:l,processing:c,errors:i,reset:h}=q({type:(a==null?void 0:a.type)||"",impact:(a==null?void 0:a.impact)||"",status:(a==null?void 0:a.status)||"Normal",recommendation:(a==null?void 0:a.recommendation)||""}),[m,x]=u.useState(!1),v=[{value:"Normal",label:"Normal"},{value:"Tinggi",label:"Tinggi"}],N=k=>{k.preventDefault(),x(!0),p?l(route("risks.update",a.id),{onSuccess:()=>{o(),h()},onError:()=>{x(!1)},onFinish:()=>{x(!1)}}):t(route("risks.store"),{onSuccess:()=>{o(),h()},onError:()=>{x(!1)},onFinish:()=>{x(!1)}})},b=()=>{h(),o()};return e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(C,{label:"Jenis Risiko",name:"type",value:r.type,onChange:k=>n("type",k.target.value),error:i.type,placeholder:"Masukkan jenis risiko",required:!0})}),e.jsx("div",{children:e.jsx(C,{label:"Dampak Risiko",name:"impact",value:r.impact,onChange:k=>n("impact",k.target.value),error:i.impact,placeholder:"Masukkan dampak risiko",required:!0})})]}),e.jsx("div",{children:e.jsx(L,{label:"Status Risiko",name:"status",value:r.status,onChange:k=>n("status",k.target.value),error:i.status,options:v,required:!0})}),e.jsx("div",{children:e.jsx(A,{label:"Rekomendasi Penanganan",name:"recommendation",value:r.recommendation,onChange:k=>n("recommendation",k.target.value),error:i.recommendation,placeholder:"Masukkan rekomendasi penanganan risiko",rows:4,required:!0})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(j,{type:"button",variant:"outline",onClick:b,disabled:c||m,children:"Batal"}),e.jsx(j,{type:"submit",disabled:c||m,className:"bg-blue-600 hover:bg-blue-700",children:c||m?"Menyimpan...":p?"Update":"Simpan"})]})]})}function Se({report:a=null,onClose:o,isEdit:p=!1}){const{data:r,setData:n,post:t,put:l,processing:c,errors:i,reset:h}=q({report_date:(a==null?void 0:a.report_date)||new Date().toISOString().split("T")[0],risk_type:(a==null?void 0:a.risk_type)||"",description:(a==null?void 0:a.description)||"",recommended_action:(a==null?void 0:a.recommended_action)||""}),[m,x]=u.useState(!1),v=b=>{b.preventDefault(),x(!0),p?l(route("risk-reports.update",a.id),{onSuccess:()=>{o(),h()},onError:()=>{x(!1)},onFinish:()=>{x(!1)}}):t(route("risk-reports.store"),{onSuccess:()=>{o(),h()},onError:()=>{x(!1)},onFinish:()=>{x(!1)}})},N=()=>{h(),o()};return e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(C,{label:"Tanggal Laporan",name:"report_date",type:"date",value:r.report_date,onChange:b=>n("report_date",b.target.value),error:i.report_date,required:!0})}),e.jsx("div",{children:e.jsx(C,{label:"Jenis Risiko",name:"risk_type",value:r.risk_type,onChange:b=>n("risk_type",b.target.value),error:i.risk_type,placeholder:"Masukkan jenis risiko",required:!0})})]}),e.jsx("div",{children:e.jsx(A,{label:"Deskripsi Risiko",name:"description",value:r.description,onChange:b=>n("description",b.target.value),error:i.description,placeholder:"Jelaskan detail risiko yang terjadi",rows:4,required:!0})}),e.jsx("div",{children:e.jsx(A,{label:"Tindakan yang Direkomendasikan",name:"recommended_action",value:r.recommended_action,onChange:b=>n("recommended_action",b.target.value),error:i.recommended_action,placeholder:"Masukkan tindakan yang direkomendasikan untuk menangani risiko",rows:4,required:!0})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(j,{type:"button",variant:"outline",onClick:N,disabled:c||m,children:"Batal"}),e.jsx(j,{type:"submit",disabled:c||m,className:"bg-green-600 hover:bg-green-700",children:c||m?"Menyimpan...":p?"Update":"Simpan"})]})]})}function De({assessment:a=null,onClose:o,isEdit:p=!1}){const{data:r,setData:n,post:t,put:l,processing:c,errors:i,reset:h}=q({respondent_name:(a==null?void 0:a.respondent_name)||"",respondent_job:(a==null?void 0:a.respondent_job)||"Manajer Bistek Operasional",risk_code:(a==null?void 0:a.risk_code)||"",risk_description:(a==null?void 0:a.risk_description)||"",severity:(a==null?void 0:a.severity)||1,occurrence:(a==null?void 0:a.occurrence)||1,detection:(a==null?void 0:a.detection)||1}),[m,x]=u.useState(!1),v=[{value:"Manajer Bistek Operasional",label:"Manajer Bistek Operasional"},{value:"Petugas Lapangan Operasional",label:"Petugas Lapangan Operasional"}],N=Array.from({length:10},(g,R)=>({value:R+1,label:`${R+1}`})),b=r.severity*r.occurrence*r.detection,k=b>=150?"Tinggi":"Normal",_=g=>{g.preventDefault(),x(!0),p?l(route("risk-assessments.update",a.id),{onSuccess:()=>{o(),h()},onError:()=>{x(!1)},onFinish:()=>{x(!1)}}):t(route("risk-assessments.store"),{onSuccess:()=>{o(),h()},onError:()=>{x(!1)},onFinish:()=>{x(!1)}})},T=()=>{h(),o()};return e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(C,{label:"Nama Responden",name:"respondent_name",value:r.respondent_name,onChange:g=>n("respondent_name",g.target.value),error:i.respondent_name,placeholder:"Masukkan nama responden",required:!0})}),e.jsx("div",{children:e.jsx(L,{label:"Posisi Responden",name:"respondent_job",value:r.respondent_job,onChange:g=>n("respondent_job",g.target.value),error:i.respondent_job,options:v,required:!0})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(C,{label:"Kode Risiko",name:"risk_code",value:r.risk_code,onChange:g=>n("risk_code",g.target.value),error:i.risk_code,placeholder:"Contoh: M01, M02, dll",required:!0})}),e.jsx("div",{children:e.jsx(A,{label:"Deskripsi Risiko",name:"risk_description",value:r.risk_description,onChange:g=>n("risk_description",g.target.value),error:i.risk_description,placeholder:"Jelaskan mode kegagalan atau risiko",rows:3,required:!0})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Penilaian FMEA"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx(L,{label:"Severity (S) - Tingkat Keparahan",name:"severity",value:r.severity,onChange:g=>n("severity",parseInt(g.target.value)),error:i.severity,options:N,required:!0}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Seberapa parah dampak jika risiko terjadi (1-10)"})]}),e.jsxs("div",{children:[e.jsx(L,{label:"Occurrence (O) - Tingkat Kemunculan",name:"occurrence",value:r.occurrence,onChange:g=>n("occurrence",parseInt(g.target.value)),error:i.occurrence,options:N,required:!0}),e.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Seberapa sering risiko kemungkinan terjadi (1-10)"})]}),e.jsxs("div",{children:[e.jsx(L,{label:"Detection (D) - Tingkat Deteksi",name:"detection",value:r.detection,onChange:g=>n("detection",parseInt(g.target.value)),error:i.detection,options:N,required:!0}),e.jsx("p",{className:"text-xs text-orange-700 mt-1",children:"Seberapa mudah risiko dapat dideteksi (1-10)"})]})]}),e.jsx("div",{className:"mt-6 bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Risk Priority Number (RPN)"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["S × O × D = ",r.severity," × ",r.occurrence," × ",r.detection]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:b}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${k==="Tinggi"?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:k})]})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(j,{type:"button",variant:"outline",onClick:T,disabled:c||m,children:"Batal"}),e.jsx(j,{type:"submit",disabled:c||m,className:"bg-purple-600 hover:bg-purple-700",children:c||m?"Menyimpan...":p?"Update":"Simpan"})]})]})}function Ee({isOpen:a,onClose:o,onConfirm:p,title:r,message:n,itemName:t,isDeleting:l=!1}){return a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center mb-4",children:e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:n}),t&&e.jsxs("p",{className:"text-sm font-medium text-gray-900 bg-gray-100 p-3 rounded-md",children:['"',t,'"']}),e.jsx("p",{className:"text-xs text-red-600 mt-2",children:"Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx(j,{type:"button",variant:"outline",onClick:o,disabled:l,children:"Batal"}),e.jsx(j,{type:"button",onClick:p,disabled:l,className:"bg-red-600 hover:bg-red-700",children:l?"Menghapus...":"Hapus"})]})]})})}):null}Ne.register(ye,we,Me,Ce,Re,Le,_e);function He({risks:a,riskStatus:o,riskReports:p,riskStats:r,riskAssessments:n,fmeaAnalysisSummary:t,flash:l}){const[c,i]=u.useState(!1),[h,m]=u.useState(!1),[x,v]=u.useState(!1),[N,b]=u.useState(!1),[k,_]=u.useState(null),[T,g]=u.useState(null),[R,I]=u.useState(null),[y,J]=u.useState(null),[S,V]=u.useState(""),[Q,$]=u.useState(!1),[D,X]=u.useState(""),[E,Y]=u.useState("Semua"),[w,O]=u.useState("risks"),[W,U]=u.useState({isVisible:!1,message:"",type:"info"}),B=(s,d="info")=>{U({isVisible:!0,message:s,type:d})},ee=()=>{U({isVisible:!1,message:"",type:"info"})};u.useEffect(()=>{l!=null&&l.success?B(l.success,"success"):l!=null&&l.error&&B(l.error,"error")},[l]);const se=[{header:"No.",accessor:null,cell:(s,d,f)=>f+1},{header:"Jenis Risiko",accessor:"type"},{header:"Dampak",accessor:"impact"},{header:"Status",accessor:"status",cell:s=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${s==="Tinggi"?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:s})},{header:"Rekomendasi",accessor:"recommendation",cell:s=>e.jsx("div",{className:"max-w-xs whitespace-normal break-words text-sm",children:s})},{header:"Aksi",accessor:null,cell:(s,d)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>de(d),className:"text-blue-600 hover:text-blue-800",children:"Edit"}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>H(d,"risk"),className:"text-red-600 hover:text-red-800",children:"Hapus"})]})}],ae=[{header:"No.",accessor:null,cell:(s,d,f)=>f+1},{header:"Tanggal",accessor:"report_date",cell:s=>new Date(s).toLocaleDateString("id-ID")},{header:"Jenis Risiko",accessor:"risk_type"},{header:"Deskripsi",accessor:"description",cell:s=>e.jsx("div",{className:"max-w-xs whitespace-normal break-words text-sm",children:s})},{header:"Tindakan",accessor:"recommended_action",cell:s=>e.jsx("div",{className:"max-w-xs whitespace-normal break-words text-sm",children:s})},{header:"Aksi",accessor:null,cell:(s,d)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>xe(d),className:"text-blue-600 hover:text-blue-800",children:"Edit"}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>H(d,"report"),className:"text-red-600 hover:text-red-800",children:"Hapus"})]})}],re=[{header:"No.",accessor:null,cell:(s,d,f)=>f+1},{header:"Pekerjaan Responden",accessor:"respondent_job",cell:s=>e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:s})},{header:"Kode",accessor:"risk_code",cell:s=>e.jsx("span",{className:"font-mono font-bold text-purple-700",children:s})},{header:"Severity",accessor:"severity",cell:s=>e.jsx("span",{className:`font-bold px-2 py-1 rounded ${s>=7?"bg-red-100 text-red-800":s>=4?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s})},{header:"Occurrence",accessor:"occurrence",cell:s=>e.jsx("span",{className:`font-bold px-2 py-1 rounded ${s>=7?"bg-red-100 text-red-800":s>=4?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s})},{header:"Detection",accessor:"detection",cell:s=>e.jsx("span",{className:`font-bold px-2 py-1 rounded ${s>=7?"bg-red-100 text-red-800":s>=4?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s})},{header:"RPN",accessor:null,cell:(s,d)=>{const f=d.severity*d.occurrence*d.detection,Z=f>=150?"Tinggi":"Normal";return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-lg",children:f}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${Z==="Tinggi"?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:Z})]})}},{header:"Aksi",accessor:null,cell:(s,d)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>me(d),className:"text-blue-600 hover:text-blue-800",children:"Edit"}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>H(d,"assessment"),className:"text-red-600 hover:text-red-800",children:"Hapus"})]})}],te=[{header:"Kode",accessor:"kode",cell:s=>e.jsx("span",{className:"font-mono font-bold text-purple-700",children:s})},{header:"Deskripsi",accessor:"deskripsi",cell:s=>e.jsx("div",{className:"max-w-xs whitespace-normal break-words text-sm",children:s})},{header:"Avg S",accessor:"avg_severity",cell:s=>e.jsx("span",{className:"font-bold text-blue-600",children:s})},{header:"Avg O",accessor:"avg_occurrence",cell:s=>e.jsx("span",{className:"font-bold text-green-600",children:s})},{header:"Avg D",accessor:"avg_detection",cell:s=>e.jsx("span",{className:"font-bold text-orange-600",children:s})},{header:"RPN",accessor:"avg_rpn",cell:s=>e.jsx("span",{className:"font-extrabold text-lg text-gray-800",children:s})},{header:"Tingkat Risiko",accessor:"tingkat_risiko",cell:s=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${s==="Tinggi"?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:s})}],ne=u.useMemo(()=>!n||!Array.isArray(n)?[]:n.filter(s=>{const d=s.risk_code.toLowerCase().includes(D.toLowerCase())||s.risk_description.toLowerCase().includes(D.toLowerCase()),f=E==="Semua"||s.respondent_job===E;return d&&f}),[n,D,E]),z=u.useMemo(()=>{const s={Tinggi:0,Normal:0};return t&&Array.isArray(t)&&t.forEach(d=>{s.hasOwnProperty(d.tingkat_risiko)&&s[d.tingkat_risiko]++}),s},[t]),le={labels:Object.keys(z),datasets:[{data:Object.values(z),backgroundColor:["#ef4444","#10b981"],borderColor:"#ffffff",borderWidth:3}]},ie={labels:t&&Array.isArray(t)?t.slice(0,10).map(s=>s.kode):[],datasets:[{label:"Risk Priority Number (RPN)",data:t&&Array.isArray(t)?t.slice(0,10).map(s=>s.avg_rpn):[],backgroundColor:t&&Array.isArray(t)?t.slice(0,10).map(s=>s.tingkat_risiko==="Tinggi"?"#ef4444":"#10b981"):[],borderColor:"#374151",borderWidth:1}]},G={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:F.colors.neutral[700],font:{size:12}}},title:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{color:F.colors.neutral[600]},grid:{color:F.colors.neutral[200]}},x:{ticks:{color:F.colors.neutral[600]},grid:{display:!1}}}},oe=()=>{_(null),i(!0)},de=s=>{_(s),i(!0)},ce=()=>{g(null),m(!0)},xe=s=>{g(s),m(!0)},ue=()=>{I(null),v(!0)},me=s=>{I(s),v(!0)},H=(s,d)=>{J(s),V(d),b(!0)},M=()=>{i(!1),m(!1),v(!1),b(!1),_(null),g(null),I(null),J(null),V("")},pe=()=>{if(!y||!S)return;$(!0);let s="",d="",f="";switch(S){case"risk":s="risks.destroy",d=y.id,f="Data risiko berhasil dihapus";break;case"report":s="risk-reports.destroy",d=y.id,f="Laporan risiko berhasil dihapus";break;case"assessment":s="risk-assessments.destroy",d=y.id,f="Assessment FMEA berhasil dihapus";break;default:return}be.delete(route(s,d),{onSuccess:()=>{M(),$(!1),B(f,"success")},onError:()=>{$(!1),B("Terjadi kesalahan saat menghapus data","error")}})},he=()=>{if(!y||!S)return{};switch(S){case"risk":return{title:"Hapus Data Risiko",message:"Apakah Anda yakin ingin menghapus data risiko ini?",itemName:y.type};case"report":return{title:"Hapus Laporan Risiko",message:"Apakah Anda yakin ingin menghapus laporan risiko ini?",itemName:y.risk_type};case"assessment":return{title:"Hapus Assessment FMEA",message:"Apakah Anda yakin ingin menghapus assessment FMEA ini?",itemName:y.risk_code};default:return{}}};return e.jsxs(je,{children:[e.jsx(ge,{title:"Manajemen Risiko - Analisis Risiko"}),e.jsx(ke,{title:"Manajemen Risiko",subtitle:"Kelola dan pantau risiko operasional pelabuhan",breadcrumb:[{label:"Dashboard",href:"/dashboard"},{label:"Risiko",current:!0}]}),e.jsxs("div",{className:"p-8 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Risiko"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(r==null?void 0:r.total)||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-orange-100 text-orange-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Risiko Tinggi"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:(r==null?void 0:r.tinggi)||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100 text-green-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Status Keseluruhan"}),e.jsx("p",{className:`text-2xl font-bold ${o==="Tinggi"?"text-red-600":"text-green-600"}`,children:o})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Distribusi Tingkat Risiko"}),e.jsx("div",{className:"h-64",children:Object.values(z).some(s=>s>0)?e.jsx(fe,{data:le,options:G}):e.jsx("p",{className:"text-gray-500 text-center pt-24",children:"Tidak ada data untuk ditampilkan"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Top 10 Risk Priority Number (RPN)"}),e.jsx("div",{className:"h-64",children:t&&t.length>0?e.jsx(ve,{data:ie,options:G}):e.jsx("p",{className:"text-gray-500 text-center pt-24",children:"Tidak ada data untuk ditampilkan"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-6",children:[e.jsx("button",{onClick:()=>O("risks"),className:`py-4 px-1 border-b-2 font-medium text-sm ${w==="risks"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Data Risiko"}),e.jsx("button",{onClick:()=>O("reports"),className:`py-4 px-1 border-b-2 font-medium text-sm ${w==="reports"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Laporan Risiko"}),e.jsx("button",{onClick:()=>O("assessments"),className:`py-4 px-1 border-b-2 font-medium text-sm ${w==="assessments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Assessment FMEA"}),e.jsx("button",{onClick:()=>O("analysis"),className:`py-4 px-1 border-b-2 font-medium text-sm ${w==="analysis"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Hasil Analisis FMEA"})]})}),e.jsxs("div",{className:"p-6",children:[w==="risks"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Data Risiko"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Kelola data risiko operasional pelabuhan"})]}),e.jsxs(j,{onClick:oe,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tambah Risiko"]})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-200",children:e.jsx(P,{columns:se,data:a||[]})})]}),w==="reports"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Laporan Risiko"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Kelola laporan kejadian risiko"})]}),e.jsxs(j,{onClick:ce,className:"bg-green-600 hover:bg-green-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tambah Laporan"]})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-200",children:e.jsx(P,{columns:ae,data:p||[]})})]}),w==="assessments"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Assessment FMEA"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Kelola penilaian FMEA (Failure Mode and Effect Analysis)"})]}),e.jsxs(j,{onClick:ue,className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tambah Assessment"]})]}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Cari berdasarkan nama, kode, atau deskripsi...",value:D,onChange:s=>X(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsx("div",{children:e.jsxs("select",{value:E,onChange:s=>Y(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"Semua",children:"Semua Posisi"}),e.jsx("option",{value:"Manajer Bistek Operasional",children:"Manajer Bistek Operasional"}),e.jsx("option",{value:"Petugas Lapangan Operasional",children:"Petugas Lapangan Operasional"})]})})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-200",children:e.jsx(P,{columns:re,data:ne})})]}),w==="analysis"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-1",children:"Hasil Analisis FMEA"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Ringkasan analisis risiko berdasarkan rata-rata penilaian responden"}),e.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-bold text-blue-900 mb-3 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Keterangan Metode FMEA"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white p-3 rounded-md border-l-4 border-blue-500",children:[e.jsx("strong",{className:"text-blue-900",children:"Severity (S):"}),e.jsx("p",{className:"text-blue-800 mt-1",children:"Seberapa parah dampak jika risiko terjadi"})]}),e.jsxs("div",{className:"bg-white p-3 rounded-md border-l-4 border-green-500",children:[e.jsx("strong",{className:"text-green-900",children:"Occurrence (O):"}),e.jsx("p",{className:"text-green-800 mt-1",children:"Seberapa sering risiko kemungkinan terjadi"})]}),e.jsxs("div",{className:"bg-white p-3 rounded-md border-l-4 border-orange-500",children:[e.jsx("strong",{className:"text-orange-900",children:"Detection (D):"}),e.jsx("p",{className:"text-orange-800 mt-1",children:"Seberapa mudah risiko dapat dideteksi"})]})]}),e.jsx("div",{className:"mt-3 text-center bg-white p-2 rounded-md",children:e.jsx("strong",{className:"text-gray-900",children:"Risk Priority Number (RPN) = S × O × D"})})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-200",children:e.jsx(P,{columns:te,data:t||[]})}),e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-red-50 to-orange-50 rounded-xl border border-red-200 p-6",children:[e.jsxs("h4",{className:"text-xl font-bold text-red-900 mb-3 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})}),"HASIL FMEA TINGKAT RISIKO OPERASIONAL PELABUHAN"]}),e.jsx("p",{className:"text-red-800 mb-6 font-medium",children:"Hasil mitigasi risiko dengan tingkat risiko tertinggi berdasarkan perhitungan RPN."}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full bg-white rounded-lg shadow-sm",children:[e.jsx("thead",{className:"bg-red-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-sm",children:"Kode"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-sm",children:"Mode Kegagalan"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-sm",children:"RPN"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-sm",children:"Mitigasi Risiko"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"font-mono font-bold text-purple-700 bg-purple-100 px-2 py-1 rounded",children:"M01"})}),e.jsx("td",{className:"px-4 py-4 text-gray-900",children:"Data peti kemas tidak tercatat atau salah"}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-bold text-red-600 bg-red-100 px-3 py-1 rounded-full",children:"196,92"})}),e.jsx("td",{className:"px-4 py-4 text-gray-700 text-sm",children:"Wajibkan semua petugas menerima dokumen muatan resmi dari pihak pelayaran sebelum kegiatan dimulai."})]}),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"font-mono font-bold text-purple-700 bg-purple-100 px-2 py-1 rounded",children:"M04"})}),e.jsx("td",{className:"px-4 py-4 text-gray-900",children:"Jadwal kapal tumpang tindih"}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-bold text-orange-600 bg-orange-100 px-3 py-1 rounded-full",children:"151,25"})}),e.jsx("td",{className:"px-4 py-4 text-gray-700 text-sm",children:"Terapkan sistem jadwal berbasis shift harian tetap dan larangan perubahan mendadak tanpa persetujuan."})]}),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"font-mono font-bold text-purple-700 bg-purple-100 px-2 py-1 rounded",children:"M05"})}),e.jsx("td",{className:"px-4 py-4 text-gray-900",children:"Kapal pandu tidak tersedia saat dibutuhkan"}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-bold text-orange-600 bg-orange-100 px-3 py-1 rounded-full",children:"153,90"})}),e.jsx("td",{className:"px-4 py-4 text-gray-700 text-sm",children:"Buat sistem giliran kerja dan siaga (standby) bagi kapal pandu di jam sibuk atau waktu padat sandar."})]}),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"font-mono font-bold text-purple-700 bg-purple-100 px-2 py-1 rounded",children:"M07"})}),e.jsx("td",{className:"px-4 py-4 text-gray-900",children:"Laporan tidak terkirim tepat waktu"}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-bold text-orange-600 bg-orange-100 px-3 py-1 rounded-full",children:"156,24"})}),e.jsx("td",{className:"px-4 py-4 text-gray-700 text-sm",children:"Tetapkan jam batas pelaporan harian di SOP dan beri teguran resmi jika melewati batas waktu."})]}),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"font-mono font-bold text-purple-700 bg-purple-100 px-2 py-1 rounded",children:"M08"})}),e.jsx("td",{className:"px-4 py-4 text-gray-900",children:"Data kapal dan peti kemas tidak sinkron"}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-bold text-red-600 bg-red-100 px-3 py-1 rounded-full",children:"197,39"})}),e.jsx("td",{className:"px-4 py-4 text-gray-700 text-sm",children:"Buat tim verifikasi gabungan dari divisi kapal dan logistik yang bertugas mencocokkan data sebelum bongkar."})]}),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"font-mono font-bold text-purple-700 bg-purple-100 px-2 py-1 rounded",children:"M09"})}),e.jsx("td",{className:"px-4 py-4 text-gray-900",children:"Kecelakaan kerja saat bongkar muat"}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-bold text-orange-600 bg-orange-100 px-3 py-1 rounded-full",children:"155,02"})}),e.jsx("td",{className:"px-4 py-4 text-gray-700 text-sm",children:"Wajibkan briefing keselamatan sebelum shift dimulai dan pengawasan langsung oleh mandor tiap kegiatan."})]}),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"font-mono font-bold text-purple-700 bg-purple-100 px-2 py-1 rounded",children:"M20"})}),e.jsx("td",{className:"px-4 py-4 text-gray-900",children:"Informasi status kapal tidak seragam"}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"font-bold text-orange-600 bg-orange-100 px-3 py-1 rounded-full",children:"155,60"})}),e.jsx("td",{className:"px-4 py-4 text-gray-700 text-sm",children:"Buat daftar istilah status kapal resmi dan adakan pelatihan setiap bulan untuk semua petugas operasional."})]})]})]})})]})]})]})]})]}),e.jsx(K,{show:c,onClose:M,title:k?"Edit Data Risiko":"Tambah Data Risiko",maxWidth:"lg",children:e.jsx(Ae,{risk:k,onClose:M,isEdit:!!k})}),e.jsx(K,{show:h,onClose:M,title:T?"Edit Laporan Risiko":"Tambah Laporan Risiko",maxWidth:"lg",children:e.jsx(Se,{report:T,onClose:M,isEdit:!!T})}),e.jsx(K,{show:x,onClose:M,title:R?"Edit Assessment FMEA":"Tambah Assessment FMEA",maxWidth:"xl",children:e.jsx(De,{assessment:R,onClose:M,isEdit:!!R})}),e.jsx(Ee,{isOpen:N,onClose:M,onConfirm:pe,isDeleting:Q,...he()}),e.jsx(Te,{isVisible:W.isVisible,message:W.message,type:W.type,onClose:ee})]})}export{He as default};
